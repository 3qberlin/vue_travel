import{_ as A,m as w,a as C,r as c,i as I,o as _,c as p,d as o,b as t,F as y,j as M,t as i,w as h,g as S,e as n,n as f,k as $}from"./index-qQE9ngqJ.js";import{S as D,c as V}from"./cartPinia-LZcYaXFZ.js";import{a as b}from"./axios-G2rPRu76.js";import{T as U,t as T}from"./TravelConditions-5BsSgV0q.js";var j={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_NAME:"berlin",BASE_URL:"/vue_week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:v,VITE_API_NAME:x}=j,L={computed:{...w(V,["final_total","total"]),...w(T,["selectedPeople","startTime","endTime"])},methods:{...C(V,["getCarts","pinia_carts","carts"]),...C(T,["setPeople","getStart","getEnd"]),addProduct(s){const e={product_id:s.product_id,qty:s.qty+1},d=`${v}/api/${x}/cart/${s.id}`;b.put(d,{data:e}).then(()=>{this.carts.qty=e.qty,this.getCarts()})},reduceProduct(s){const e={product_id:s.product_id,qty:s.qty-1},d=`${v}/api/${x}/cart/${s.id}`;b.put(d,{data:e}).then(()=>{this.carts.qty=e.qty,this.getCarts()})},couponTicket(){const s={code:this.couponContent},e=`${v}/api/${x}/coupon`;b.post(e,{data:s}).then(d=>{this.final_total=d.data.data.final_total,this.getCarts()})},buildOrder(){const s=`${v}/api/${x}/order`,e=this.form;b.post(s,{data:e}).then(()=>{this.$router.push({name:"checkoutSuccess"}),this.getCarts()}).catch(()=>{D.fire({icon:"error",title:"表單未正確填寫",text:"請依提示填寫"})})}},mounted(){this.getCarts()},data(){return{couponContent:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{TravelConditions:U}},R={key:0,class:"container"},B=t("div",{class:"row justify-content-center"},[t("div",{class:"col-md-10"},[t("h3",{class:"fw-bold mb-4 pt-3"},"結帳")])],-1),O={class:"row flex-row-reverse justify-content-center pb-5"},F={class:"col-md-4"},z={class:"border p-4 mb-4"},G=["src"],H={class:"w-100"},J={class:"d-flex justify-content-between"},K={class:"mb-0 fw-bold"},Q={class:"mb-0"},W={class:"mb-0 fw-bold"},X=t("h4",{class:"fw-bold mb-4"},"訂單資料",-1),Y={class:"table mt-4 border-top border-bottom text-muted"},Z=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),tt={class:"text-end border-0 px-0 pt-4"},et=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"LinePay")],-1),st={class:"d-flex justify-content-between mt-4"},ot=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),at={class:"mb-0 h4 fw-bold"},lt={class:"col-md-6"},nt=t("p",null,"聯絡資訊",-1),rt={class:"mb-0"},dt=t("label",{for:"ContactMail",class:"text-muted mb-0"},[t("span",{class:"text-danger"},"*"),n(" Email ")],-1),ct={class:"mb-2"},it=t("label",{for:"ContactName",class:"text-muted mb-0 mt-2"},[t("span",{class:"text-danger"},"*"),n(" 姓名 ")],-1),mt={class:"mb-2"},ut=t("label",{for:"ContactTel",class:"text-muted mb-0 mt-2"},[t("span",{class:"text-danger"},"*"),n(" 電話 ")],-1),_t={class:"mb-2"},pt=t("label",{for:"ContactAddress",class:"text-muted mb-0 mt-2"},[t("span",{class:"text-danger"},"*"),n(" 地址 ")],-1),ht=t("label",{for:"travelDate",class:"text-muted mb-0 mt-2"},"旅遊期間",-1),ft=["value"],bt={class:"mb-2"},vt=t("label",{for:"travelPeopleNum",class:"text-muted mb-0 mt-2"},"人數",-1),xt=["value"],gt={class:"mb-2"},wt=t("label",{for:"ContactMessage",class:"text-muted mb-0"},"備註",-1),Ct={class:"form-control",rows:"3",id:"ContactMessage",placeholder:"其他留言"},yt={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-center align-items-end w-100"},Vt=t("i",{class:"bi bi-arrow-left"},null,-1),Tt=t("a",{class:"ms-3 text-decoration-none text-muted text-nowrap h-100"},"回 購物車",-1),kt={class:"fs-5 text-center my-10"};function Pt(s,e,d,Et,l,k){const P=c("TravelConditions"),m=c("v-field"),u=c("ErrorMessage"),E=c("v-form"),g=c("RouterLink"),N=c("router-link"),q=I("modal");return _(),p(y,null,[this.carts.length>=1?(_(),p("div",R,[o(P,{class:"d-none"}),B,t("div",O,[t("div",F,[t("div",z,[(_(!0),p(y,null,M(s.carts,a=>(_(),p("div",{class:"d-flex",key:a},[t("img",{src:a.product.imagesUrl,alt:"productImages",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,G),t("div",H,[t("div",J,[t("p",K,i(a.product.title),1),t("p",Q,"NT$"+i(a.product.price),1)]),t("p",W,i(a.product.num)+" 組",1)])]))),128)),X,t("table",Y,[t("tbody",null,[t("tr",null,[Z,t("td",tt," NT$"+i(this.final_total),1)]),et])]),t("div",st,[ot,t("p",at,"NT$"+i(this.final_total),1)])])]),t("div",lt,[nt,o(E,null,{default:h(({errors:a})=>[t("div",rt,[dt,o(m,{name:"email",type:"email",rules:"required|email",class:f(["form-control",{"is-invalid":a.email}]),id:"ContactMail",placeholder:"example@gmail.com",modelValue:l.form.user.email,"onUpdate:modelValue":e[0]||(e[0]=r=>l.form.user.email=r)},null,8,["modelValue","class"]),o(u,{class:"text-danger",name:"email"})]),t("div",ct,[it,o(m,{name:"姓名",type:"text",rules:"required",class:f(["form-control",{"is-invalid":a.姓名}]),id:"ContactName",placeholder:"王 小明",modelValue:l.form.user.name,"onUpdate:modelValue":e[1]||(e[1]=r=>l.form.user.name=r)},null,8,["modelValue","class"]),o(u,{class:"text-danger",name:"姓名"})]),t("div",mt,[ut,o(m,{name:"電話",type:"tel",rules:"required",class:f(["form-control",{"is-invalid":a.電話}]),id:"ContactTel",placeholder:"0912345678",modelValue:l.form.user.tel,"onUpdate:modelValue":e[2]||(e[2]=r=>l.form.user.tel=r)},null,8,["modelValue","class"]),o(u,{class:"text-danger",name:"電話"})]),t("div",_t,[pt,o(m,{name:"地址",type:"text",rules:"required",class:f(["form-control",{"is-invalid":a.地址}]),id:"ContactAddress",placeholder:"台灣台北市大安區羅斯福利101號",modelValue:l.form.user.address,"onUpdate:modelValue":e[3]||(e[3]=r=>l.form.user.address=r)},null,8,["modelValue","class"]),o(u,{class:"text-danger",name:"地址"})]),t("div",null,[ht,t("input",{type:"text",class:"form-control",id:"travelDate",disabled:"",value:s.startTime+"   到   "+s.endTime},null,8,ft)]),t("div",bt,[vt,t("input",{type:"text",class:"form-control",id:"travelPeopleNum",disabled:"",value:s.selectedPeople},null,8,xt)]),t("div",gt,[wt,$(t("textarea",Ct,null,512),[[q,l.form.message]])])]),_:1}),t("div",yt,[o(g,{to:"/cart",class:"text-dark mt-md-0 mt-3 d-flex align-items-center"},{default:h(()=>[Vt,Tt]),_:1}),o(g,{to:"/checkout",class:"mx-5 btn btn-dark w-100 mt-4",onClick:e[4]||(e[4]=a=>k.buildOrder())},{default:h(()=>[n("送出訂單")]),_:1})])])])])):S("",!0),t("div",null,[t("p",kt,[n(" 沒有任何商品，去"),o(N,{to:"/products",class:"fw-normal text-decoration-none btn btn-sm bg-dark mx-3 text-white"},{default:h(()=>[n("產品一覽")]),_:1}),n("挑一個吧！ ")])])],64)}const Mt=A(L,[["render",Pt]]);export{Mt as default};
