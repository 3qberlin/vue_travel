import{_ as v,m as w,a as T,c as a,b as t,g as u,F as $,j as q,e as p,d as y,w as g,k as E,v as P,t as r,n as V,r as C,o as d}from"./index-ByvFoFRo.js";import{c as x}from"./cartPinia-E04w01Kl.js";import{a as i}from"./axios-G2rPRu76.js";var I={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_NAME:"berlin",BASE_URL:"/vue_week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:l,VITE_API_NAME:_}=I,N={computed:{...w(x,["carts","final_total","total"])},methods:{...T(x,["getCarts","pinia_carts","carts"]),addProduct(o){const s={product_id:o.product_id,qty:o.qty+1},n=`${l}/api/${_}/cart/${o.id}`;i.put(n,{data:s}).then(()=>{this.carts.qty=s.qty,this.getCarts()})},reduceProduct(o){const s=o.qty;if(console.log("condition",s),s===1)alert("訂房數量最低為1間，欲刪除整筆請點擊紅色按鈕");else{const n={product_id:o.product_id,qty:o.qty-1},b=`${l}/api/${_}/cart/${o.id}`;i.put(b,{data:n}).then(()=>{this.carts.qty=n.qty,this.getCarts()})}},delCartItem(o){const s=`${l}/api/${_}/cart/${o}`;i.delete(s).then(()=>{this.getCarts()}).catch(n=>{alert(n.response.data.message)})},couponTicket(){const o={code:this.couponContent},s=`${l}/api/${_}/coupon`;i.post(s,{data:o}).then(n=>{this.countTotal=n.data.data.final_total,this.noneCoupon="已套用優惠券",this.getCarts()}).catch(n=>{this.noneCoupon=n.response.data.message,this.countTotal=this.total})},delCarts(){const o=`${l}/api/${_}/carts`;i.delete(o).then(()=>{this.getCarts()}).catch(()=>{})}},mounted(){this.getCarts()},data(){return{couponContent:"",noneCoupon:"",countTotal:0}}},A={class:"container"},R={class:"mt-3"},L=t("h3",{class:"mt-3 mb-4"},"購物車",-1),D={class:"row"},S={class:"col-md-8 table-responsive"},U={class:"table table-hover"},B={key:0},M={class:"text-nowrap"},j=t("th",{scope:"col",class:"border-0 ps-0"},"品項",-1),F=t("th",{scope:"col",class:"border-0"},"數量",-1),O=t("th",{scope:"col",class:"border-0"},"單價",-1),z=t("th",{scope:"col",class:"border-0"},"刪除",-1),G={scope:"col",class:"border-0 text-danger"},H={key:1},J={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},K=["src"],Q={class:"mb-0 fw-bold ms-3 d-inline-block"},W={class:"border-0 align-middle",style:{"max-width":"160px"}},X={class:"input-group pe-5"},Y={class:"input-group-prepend"},Z={class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},tt=["onClick"],ot=["value","id"],st={class:"input-group-append"},et={class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},nt=["onClick"],at={class:"border-0 align-middle"},dt={class:"mb-0 ms-auto"},ct={class:"border-0 align-middle text-center"},rt=["onClick"],it=t("td",null,null,-1),lt={key:2},_t={class:"fs-5 text-center"},pt={key:0,class:"input-group w-50 mb-3"},ht={class:"input-group-append"},ut={class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2"},bt={key:0},mt={class:"col-md-4"},yt={class:"border p-4 mb-4"},gt=t("h4",{class:"fw-bold mb-4"},"訂單資料",-1),Ct={class:"table text-muted border-bottom"},xt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),kt={class:"text-end border-0 px-0 pt-4"},ft=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"LinePay")],-1),vt={class:"d-flex justify-content-between mt-4"},wt=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),Tt={key:0,class:"mb-0 h4 fw-bold"},$t={key:1,class:"mb-0 h4 fw-bold"};function qt(o,s,n,b,h,c){const k=C("router-link"),f=C("RouterLink");return d(),a("div",A,[t("div",R,[L,t("div",D,[t("div",S,[t("table",U,[this.carts.length>=1?(d(),a("thead",B,[t("tr",M,[j,F,O,z,t("th",G,[t("div",{class:"badge bg-danger fw-normal",onClick:s[0]||(s[0]=(...e)=>c.delCarts&&c.delCarts(...e)),style:{cursor:"pointer"}},"全刪")])])])):u("",!0),this.carts.length>=1?(d(),a("tbody",H,[(d(!0),a($,null,q(o.carts,e=>(d(),a("tr",{class:"border-bottom border-top",key:e},[t("th",J,[t("img",{src:e.product.imagesUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,K),t("p",Q,r(e.product.title),1)]),t("td",W,[t("div",X,[t("div",Y,[t("button",Z,[t("i",{class:"bi bi-dash",onClick:m=>c.reduceProduct(e)},null,8,tt)])]),t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",value:e.qty,id:e.id},null,8,ot),t("div",st,[t("button",et,[t("i",{class:"bi bi-plus-lg",onClick:m=>c.addProduct(e)},null,8,nt)])])])]),t("td",at,[t("p",dt,r(e.qty*e.product.price),1)]),t("td",ct,[t("i",{class:"bi bi-trash3 text-danger",style:{cursor:"pointer"},onClick:m=>c.delCartItem(e.id)},null,8,rt)]),it]))),128))])):(d(),a("tbody",lt,[t("p",_t,[p("沒有任何商品，去"),y(k,{to:"/products",class:"text-dark fw-bold mx-1 text-muted text-decoration-none"},{default:g(()=>[p("產品一覽")]),_:1}),p("挑一個吧！")])]))]),this.carts.length>=1?(d(),a("div",pt,[E(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"Coupon Code","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":s[1]||(s[1]=e=>h.couponContent=e)},null,512),[[P,h.couponContent]]),t("div",ht,[t("button",ut,[t("i",{class:"bi bi-ticket-perforated",onClick:s[2]||(s[2]=(...e)=>c.couponTicket&&c.couponTicket(...e))})]),this.noneCoupon?(d(),a("span",bt,r(this.noneCoupon),1)):u("",!0)])])):u("",!0)]),t("div",mt,[t("div",yt,[gt,t("table",Ct,[t("tbody",null,[t("tr",null,[xt,t("td",kt,"NT$"+r(this.total),1)]),ft])]),t("div",vt,[wt,h.countTotal>=1?(d(),a("p",Tt,"NT$"+r(this.countTotal),1)):(d(),a("p",$t,"NT$"+r(this.total),1))]),y(f,{to:"/checkout",class:V(["btn btn-dark w-100 mt-4",{disabled:this.carts.length<=0}]),tabindex:"-1"},{default:g(()=>[p("送出訂單")]),_:1},8,["class"])])])])])])}const It=v(N,[["render",qt]]);export{It as default};
