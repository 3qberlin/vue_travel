import{_ as v,m as w,a as T,c as a,b as t,g as h,F as $,j as q,e as i,d as y,w as k,k as E,v as P,t as c,n as V,r as f,o as d}from"./index-CMY_Dr_p.js";import{c as x}from"./cartPinia-9oOhhv6U.js";import{a as l}from"./axios-G2rPRu76.js";var I={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_NAME:"berlin",BASE_URL:"/vue_week8/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:p,VITE_API_NAME:_}=I,N={computed:{...w(x,["carts","final_total","total"])},methods:{...T(x,["getCarts","pinia_carts","carts"]),addProduct(o){const s={product_id:o.product_id,qty:o.qty+1},n=`${p}/api/${_}/cart/${o.id}`;l.put(n,{data:s}).then(()=>{this.carts.qty=s.qty,this.getCarts()})},reduceProduct(o){const s=o.qty;if(console.log("condition",s),s===1)alert("訂房數量最低為1間，欲刪除整筆請點擊紅色按鈕");else{const n={product_id:o.product_id,qty:o.qty-1},b=`${p}/api/${_}/cart/${o.id}`;l.put(b,{data:n}).then(()=>{this.carts.qty=n.qty,this.getCarts()})}},delCartItem(o){const s=`${p}/api/${_}/cart/${o}`;l.delete(s).then(()=>{this.getCarts()}).catch(n=>{alert(n.response.data.message)})},couponTicket(){const o={code:this.couponContent},s=`${p}/api/${_}/coupon`;l.post(s,{data:o}).then(n=>{this.countTotal=n.data.data.final_total,this.noneCoupon="已套用優惠券",this.getCarts()}).catch(n=>{this.noneCoupon=n.response.data.message,this.countTotal=this.total})}},mounted(){this.getCarts()},data(){return{couponContent:"",noneCoupon:"",countTotal:0}}},A={class:"container"},R={class:"mt-3"},L=t("h3",{class:"mt-3 mb-4"},"購物車",-1),D={class:"row"},S={class:"col-md-8"},U={class:"table"},B={key:0},M=t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"品項"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"單價"),t("th",{scope:"col",class:"border-0"})],-1),j=[M],F={key:1},O={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},z=["src"],G={class:"mb-0 fw-bold ms-3 d-inline-block"},H={class:"border-0 align-middle",style:{"max-width":"160px"}},J={class:"input-group pe-5"},K={class:"input-group-prepend"},Q={class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},W=["onClick"],X=["value","id"],Y={class:"input-group-append"},Z={class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},tt=["onClick"],ot={class:"border-0 align-middle"},st={class:"mb-0 ms-auto"},et={class:"border-0 align-middle"},nt=["onClick"],at={key:2},dt={class:"fs-5 text-center"},ct={key:0,class:"input-group w-50 mb-3"},rt={class:"input-group-append"},it={class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2"},lt={key:0},pt={class:"col-md-4"},_t={class:"border p-4 mb-4"},ut=t("h4",{class:"fw-bold mb-4"},"訂單資料",-1),ht={class:"table text-muted border-bottom"},bt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),mt={class:"text-end border-0 px-0 pt-4"},yt=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"LinePay")],-1),kt={class:"d-flex justify-content-between mt-4"},ft=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),xt={key:0,class:"mb-0 h4 fw-bold"},gt={key:1,class:"mb-0 h4 fw-bold"};function Ct(o,s,n,b,u,r){const g=f("router-link"),C=f("RouterLink");return d(),a("div",A,[t("div",R,[L,t("div",D,[t("div",S,[t("table",U,[this.carts.length>=1?(d(),a("thead",B,j)):h("",!0),this.carts.length>=1?(d(),a("tbody",F,[(d(!0),a($,null,q(o.carts,e=>(d(),a("tr",{class:"border-bottom border-top",key:e},[t("th",O,[t("img",{src:e.product.imagesUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,z),t("p",G,c(e.product.title),1)]),t("td",H,[t("div",J,[t("div",K,[t("button",Q,[t("i",{class:"bi bi-dash",onClick:m=>r.reduceProduct(e)},null,8,W)])]),t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",value:e.qty,id:e.id},null,8,X),t("div",Y,[t("button",Z,[t("i",{class:"bi bi-plus-lg",onClick:m=>r.addProduct(e)},null,8,tt)])])])]),t("td",ot,[t("p",st,c(e.qty*e.product.price),1)]),t("td",et,[t("i",{class:"bi bi-trash3 text-danger",style:{cursor:"pointer"},onClick:m=>r.delCartItem(e.id)},null,8,nt)])]))),128))])):(d(),a("tbody",at,[t("p",dt,[i("沒有任何商品，去"),y(g,{to:"/products",class:"text-dark fw-bold mx-1 text-muted text-decoration-none"},{default:k(()=>[i("產品一覽")]),_:1}),i("挑一個吧！")])]))]),this.carts.length>=1?(d(),a("div",ct,[E(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"Coupon Code","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":s[0]||(s[0]=e=>u.couponContent=e)},null,512),[[P,u.couponContent]]),t("div",rt,[t("button",it,[t("i",{class:"bi bi-ticket-perforated",onClick:s[1]||(s[1]=(...e)=>r.couponTicket&&r.couponTicket(...e))})]),this.noneCoupon?(d(),a("span",lt,c(this.noneCoupon),1)):h("",!0)])])):h("",!0)]),t("div",pt,[t("div",_t,[ut,t("table",ht,[t("tbody",null,[t("tr",null,[bt,t("td",mt,"NT$"+c(this.total),1)]),yt])]),t("div",kt,[ft,u.countTotal>=1?(d(),a("p",xt,"NT$"+c(this.countTotal),1)):(d(),a("p",gt,"NT$"+c(this.total),1))]),y(C,{to:"/checkout",class:V(["btn btn-dark w-100 mt-4",{disabled:this.carts.length<=0}]),tabindex:"-1"},{default:k(()=>[i("送出訂單")]),_:1},8,["class"])])])])])])}const $t=v(N,[["render",Ct]]);export{$t as default};
