import{_ as S,m as x,a as w,L as k,r as d,i as A,o as v,c as g,b as t,d as l,F as C,j as M,t as r,w as y,n as u,k as I,l as U,e as h}from"./index-PTrqyE5n.js";import{S as D,c as V}from"./cartPinia-OEHp7cEO.js";import{a as _}from"./axios-G2rPRu76.js";import{T as j,t as T}from"./TravelConditions-mlP5wwSo.js";var R={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_API_NAME:"berlin",BASE_URL:"/vue_travel/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:p,VITE_API_NAME:f}=R,O={computed:{...x(V,["final_total","total"]),...x(T,["selectedPeople","startTime","endTime"])},methods:{...w(V,["getCarts","pinia_carts","carts"]),...w(T,["setPeople","getStart","getEnd"]),addProduct(s){const e={product_id:s.product_id,qty:s.qty+1},i=`${p}/api/${f}/cart/${s.id}`;_.put(i,{data:e}).then(()=>{this.carts.qty=e.qty,this.getCarts()})},reduceProduct(s){const e={product_id:s.product_id,qty:s.qty-1},i=`${p}/api/${f}/cart/${s.id}`;_.put(i,{data:e}).then(()=>{this.carts.qty=e.qty,this.getCarts()})},couponTicket(){const s={code:this.couponContent},e=`${p}/api/${f}/coupon`;_.post(e,{data:s}).then(i=>{this.final_total=i.data.data.final_total,this.getCarts()})},buildOrder(){const s=`${p}/api/${f}/order`,e=this.form;_.post(s,{data:e}).then(()=>{this.$router.push({name:"checkoutSuccess"}),this.getCarts()}).catch(()=>{D.fire({icon:"error",title:"表單未正確填寫",text:"請依提示填寫"})})},showLoading(){this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},550)}},mounted(){this.getCarts(),this.showLoading()},data(){return{couponContent:"",form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!0,fullPage:!0}},components:{TravelConditions:j,Loading:k}},B={class:"container"},$=t("div",{class:"row justify-content-center"},[t("div",{class:"col-md-10"},[t("h3",{class:"fw-bold mb-4 pt-3"},"結帳")])],-1),F={class:"row flex-row-reverse justify-content-center pb-5"},z={class:"col-md-4"},G={class:"border p-4 mb-4"},H=["src"],J={class:"w-100"},K={class:"d-flex justify-content-between"},Q={class:"mb-0 fw-bold"},W={class:"mb-0"},X={class:"mb-0 fw-bold"},Y=t("h4",{class:"fw-bold mb-4"},"訂單資料",-1),Z={class:"table mt-4 border-top border-bottom text-muted"},tt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),et={class:"text-end border-0 px-0 pt-4"},st=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 付款方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"LinePay")],-1),ot={class:"d-flex justify-content-between mt-4"},at=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),lt={class:"mb-0 h4 fw-bold"},nt={class:"col-md-6"},it=t("p",null,"聯絡資訊",-1),dt={class:"mb-0"},rt=t("label",{for:"ContactMail",class:"text-muted mb-0"},[t("span",{class:"text-danger"},"*"),h(" Email ")],-1),ct={class:"mb-2"},mt=t("label",{for:"ContactName",class:"text-muted mb-0 mt-2"},[t("span",{class:"text-danger"},"*"),h(" 姓名 ")],-1),ut={class:"mb-2"},_t=t("label",{for:"ContactTel",class:"text-muted mb-0 mt-2"},[t("span",{class:"text-danger"},"*"),h(" 電話 ")],-1),pt={class:"mb-2"},ft=t("label",{for:"ContactAddress",class:"text-muted mb-0 mt-2"},[t("span",{class:"text-danger"},"*"),h(" 地址 ")],-1),ht=t("label",{for:"travelDate",class:"text-muted mb-0 mt-2"},"旅遊期間",-1),bt=["value"],vt={class:"mb-2"},gt=t("label",{for:"travelPeopleNum",class:"text-muted mb-0 mt-2"},"人數",-1),xt=["value"],wt={class:"mb-2"},Ct=t("label",{for:"ContactMessage",class:"text-muted mb-0"},"備註",-1),yt={class:"form-control",rows:"3",id:"ContactMessage",placeholder:"其他留言"},Vt={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-center align-items-end w-100"},Tt=t("i",{class:"bi bi-arrow-left"},null,-1),Pt=t("a",{class:"ms-3 text-decoration-none text-muted text-nowrap h-100"},"回 購物車",-1);function Lt(s,e,i,Et,o,b){const P=d("TravelConditions"),c=d("v-field"),m=d("ErrorMessage"),L=d("v-form"),E=d("RouterLink"),q=d("loading"),N=A("modal");return v(),g(C,null,[t("div",B,[l(P,{class:"d-none"}),$,t("div",F,[t("div",z,[t("div",G,[(v(!0),g(C,null,M(s.carts,a=>(v(),g("div",{class:"d-flex",key:a},[t("img",{src:a.product.imagesUrl,alt:"productImages",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,H),t("div",J,[t("div",K,[t("p",Q,r(a.product.title),1),t("p",W,"NT$"+r(a.product.price),1)]),t("p",X,r(a.product.num)+" 組",1)])]))),128)),Y,t("table",Z,[t("tbody",null,[t("tr",null,[tt,t("td",et," NT$"+r(this.final_total),1)]),st])]),t("div",ot,[at,t("p",lt,"NT$"+r(this.final_total),1)])])]),t("div",nt,[it,l(L,{onSubmit:b.buildOrder},{default:y(({errors:a})=>[t("div",dt,[rt,l(c,{name:"email",type:"email",rules:"required|email",class:u(["form-control",{"is-invalid":a.email}]),id:"ContactMail",placeholder:"example@gmail.com",modelValue:o.form.user.email,"onUpdate:modelValue":e[0]||(e[0]=n=>o.form.user.email=n)},null,8,["modelValue","class"]),l(m,{class:"text-danger",name:"email"})]),t("div",ct,[mt,l(c,{name:"姓名",type:"text",rules:"required",class:u(["form-control",{"is-invalid":a.姓名}]),id:"ContactName",placeholder:"王 小明",modelValue:o.form.user.name,"onUpdate:modelValue":e[1]||(e[1]=n=>o.form.user.name=n)},null,8,["modelValue","class"]),l(m,{class:"text-danger",name:"姓名"})]),t("div",ut,[_t,l(c,{name:"電話",type:"tel",rules:"required",class:u(["form-control",{"is-invalid":a.電話}]),id:"ContactTel",placeholder:"0912345678",modelValue:o.form.user.tel,"onUpdate:modelValue":e[2]||(e[2]=n=>o.form.user.tel=n)},null,8,["modelValue","class"]),l(m,{class:"text-danger",name:"電話"})]),t("div",pt,[ft,l(c,{name:"地址",type:"text",rules:"required",class:u(["form-control",{"is-invalid":a.地址}]),id:"ContactAddress",placeholder:"台灣台北市大安區羅斯福利101號",modelValue:o.form.user.address,"onUpdate:modelValue":e[3]||(e[3]=n=>o.form.user.address=n)},null,8,["modelValue","class"]),l(m,{class:"text-danger",name:"地址"})]),t("div",null,[ht,t("input",{type:"text",class:"form-control",id:"travelDate",disabled:"",value:s.startTime+"   到   "+s.endTime},null,8,bt)]),t("div",vt,[gt,t("input",{type:"text",class:"form-control",id:"travelPeopleNum",disabled:"",value:s.selectedPeople},null,8,xt)]),t("div",wt,[Ct,I(t("textarea",yt,null,512),[[N,o.form.message]])]),t("button",{type:"submit",onSubmit:e[4]||(e[4]=U((...n)=>b.buildOrder&&b.buildOrder(...n),["prevent"])),class:"btn btn-dark w-100 mt-3"},"送出",32)]),_:1},8,["onSubmit"]),t("div",Vt,[l(E,{to:"/cart",class:"text-dark mt-md-0 mt-3 d-flex align-items-center"},{default:y(()=>[Tt,Pt]),_:1})])])])]),l(q,{active:o.isLoading,"onUpdate:active":e[5]||(e[5]=a=>o.isLoading=a),"can-cancel":!0,"is-full-page":o.fullPage},null,8,["active","is-full-page"])],64)}const At=S(O,[["render",Lt]]);export{At as default};
